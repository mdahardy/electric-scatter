var d3=function(t){"use strict";function e(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var n,i,r=(1===(n=e).length&&(i=n,n=function(t,n){return e(i(t),n)}),{left:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var o=i+r>>>1;n(t[o],e)<0?i=o+1:r=o}return i},right:function(t,e,i,r){for(null==i&&(i=0),null==r&&(r=t.length);i<r;){var o=i+r>>>1;n(t[o],e)>0?r=o:i=o+1}return i}}).right,o=Math.sqrt(50),a=Math.sqrt(10),s=Math.sqrt(2);function l(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),l=i/Math.pow(10,r);return r>=0?(l>=o?10:l>=a?5:l>=s?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(l>=o?10:l>=a?5:l>=s?2:1)}function c(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}const u=Symbol("implicit");function h(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function d(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function _(){}var f="\\s*([+-]?\\d+)\\s*",p="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",m="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",g=/^#([0-9a-f]{3,8})$/,y=new RegExp("^rgb\\("+[f,f,f]+"\\)$"),v=new RegExp("^rgb\\("+[m,m,m]+"\\)$"),w=new RegExp("^rgba\\("+[f,f,f,p]+"\\)$"),x=new RegExp("^rgba\\("+[m,m,m,p]+"\\)$"),b=new RegExp("^hsl\\("+[p,m,m]+"\\)$"),k=new RegExp("^hsla\\("+[p,m,m,p]+"\\)$"),A={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function M(){return this.rgb().formatHex()}function E(){return this.rgb().formatRgb()}function S(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=g.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?T(e):3===n?new j(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?N(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?N(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=y.exec(t))?new j(e[1],e[2],e[3],1):(e=v.exec(t))?new j(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=w.exec(t))?N(e[1],e[2],e[3],e[4]):(e=x.exec(t))?N(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=b.exec(t))?F(e[1],e[2]/100,e[3]/100,1):(e=k.exec(t))?F(e[1],e[2]/100,e[3]/100,e[4]):A.hasOwnProperty(t)?T(A[t]):"transparent"===t?new j(NaN,NaN,NaN,0):null}function T(t){return new j(t>>16&255,t>>8&255,255&t,1)}function N(t,e,n,i){return i<=0&&(t=e=n=NaN),new j(t,e,n,i)}function L(t){return t instanceof _||(t=S(t)),t?new j((t=t.rgb()).r,t.g,t.b,t.opacity):new j}function $(t,e,n,i){return 1===arguments.length?L(t):new j(t,e,n,null==i?1:i)}function j(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function H(){return"#"+I(this.r)+I(this.g)+I(this.b)}function C(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function I(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function F(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new B(t,e,n,i)}function P(t){if(t instanceof B)return new B(t.h,t.s,t.l,t.opacity);if(t instanceof _||(t=S(t)),!t)return new B;if(t instanceof B)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),o=Math.max(e,n,i),a=NaN,s=o-r,l=(o+r)/2;return s?(a=e===o?(n-i)/s+6*(n<i):n===o?(i-e)/s+2:(e-n)/s+4,s/=l<.5?o+r:2-o-r,a*=60):s=l>0&&l<1?0:a,new B(a,s,l,t.opacity)}function B(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function D(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function q(t){return function(){return t}}function Y(t){return 1==(t=+t)?W:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}(e,n,t):q(isNaN(e)?n:e)}}function W(t,e){var n=e-t;return n?function(t,e){return function(n){return t+n*e}}(t,n):q(isNaN(t)?e:t)}h(_,S,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:M,formatHex:M,formatHsl:function(){return P(this).formatHsl()},formatRgb:E,toString:E}),h(j,$,d(_,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new j(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new j(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:H,formatHex:H,formatRgb:C,toString:C})),h(B,(function(t,e,n,i){return 1===arguments.length?P(t):new B(t,e,n,null==i?1:i)}),d(_,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new B(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new B(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new j(D(t>=240?t-240:t+120,r,i),D(t,r,i),D(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var z=function t(e){var n=Y(e);function i(t,e){var i=n((t=$(t)).r,(e=$(e)).r),r=n(t.g,e.g),o=n(t.b,e.b),a=W(t.opacity,e.opacity);return function(e){return t.r=i(e),t.g=r(e),t.b=o(e),t.opacity=a(e),t+""}}return i.gamma=t,i}(1);function O(t,e){e||(e=[]);var n,i=t?Math.min(e.length,t.length):0,r=e.slice();return function(o){for(n=0;n<i;++n)r[n]=t[n]*(1-o)+e[n]*o;return r}}function R(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function G(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,o=new Array(r),a=new Array(i);for(n=0;n<r;++n)o[n]=J(t[n],e[n]);for(;n<i;++n)a[n]=e[n];return function(t){for(n=0;n<r;++n)a[n]=o[n](t);return a}}function V(t,e){var n=new Date;return t=+t,e=+e,function(i){return n.setTime(t*(1-i)+e*i),n}}function X(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function U(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=J(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var Z=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,K=new RegExp(Z.source,"g");function Q(t,e){var n,i,r,o=Z.lastIndex=K.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=Z.exec(t))&&(i=K.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:X(n,i)})),o=K.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,i=0;i<e;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})}function J(t,e){var n,i=typeof e;return null==e||"boolean"===i?q(e):("number"===i?X:"string"===i?(n=S(e))?(e=n,z):Q:e instanceof S?z:e instanceof Date?V:R(e)?O:Array.isArray(e)?G:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?U:X)(t,e)}function tt(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var et,nt,it,rt,ot=180/Math.PI,at={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function st(t,e,n,i,r,o){var a,s,l;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(s=Math.sqrt(n*n+i*i))&&(n/=s,i/=s,l/=s),t*i<e*n&&(t=-t,e=-e,l=-l,a=-a),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*ot,skewX:Math.atan(l)*ot,scaleX:a,scaleY:s}}function lt(t,e,n,i){function r(t){return t.length?t.pop()+" ":""}return function(o,a){var s=[],l=[];return o=t(o),a=t(a),function(t,i,r,o,a,s){if(t!==r||i!==o){var l=a.push("translate(",null,e,null,n);s.push({i:l-4,x:X(t,r)},{i:l-2,x:X(i,o)})}else(r||o)&&a.push("translate("+r+e+o+n)}(o.translateX,o.translateY,a.translateX,a.translateY,s,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(r(n)+"rotate(",null,i)-2,x:X(t,e)})):e&&n.push(r(n)+"rotate("+e+i)}(o.rotate,a.rotate,s,l),function(t,e,n,o){t!==e?o.push({i:n.push(r(n)+"skewX(",null,i)-2,x:X(t,e)}):e&&n.push(r(n)+"skewX("+e+i)}(o.skewX,a.skewX,s,l),function(t,e,n,i,o,a){if(t!==n||e!==i){var s=o.push(r(o)+"scale(",null,",",null,")");a.push({i:s-4,x:X(t,n)},{i:s-2,x:X(e,i)})}else 1===n&&1===i||o.push(r(o)+"scale("+n+","+i+")")}(o.scaleX,o.scaleY,a.scaleX,a.scaleY,s,l),o=a=null,function(t){for(var e,n=-1,i=l.length;++n<i;)s[(e=l[n]).i]=e.x(t);return s.join("")}}}var ct=lt((function(t){return"none"===t?at:(et||(et=document.createElement("DIV"),nt=document.documentElement,it=document.defaultView),et.style.transform=t,t=it.getComputedStyle(nt.appendChild(et),null).getPropertyValue("transform"),nt.removeChild(et),st(+(t=t.slice(7,-1).split(","))[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),ut=lt((function(t){return null==t?at:(rt||(rt=document.createElementNS("http://www.w3.org/2000/svg","g")),rt.setAttribute("transform",t),(t=rt.transform.baseVal.consolidate())?st((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):at)}),", ",")",")");function ht(t){return+t}var dt=[0,1];function _t(t){return t}function ft(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function pt(t,e,n){var i=t[0],r=t[1],o=e[0],a=e[1];return r<i?(i=ft(r,i),o=n(a,o)):(i=ft(i,r),o=n(o,a)),function(t){return o(i(t))}}function mt(t,e,n){var i=Math.min(t.length,e.length)-1,o=new Array(i),a=new Array(i),s=-1;for(t[i]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<i;)o[s]=ft(t[s],t[s+1]),a[s]=n(e[s],e[s+1]);return function(e){var n=r(t,e,1,i)-1;return a[n](o[n](e))}}function gt(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function yt(){var t,e,n,i,r,o,a=dt,s=dt,l=J,c=_t;function u(){var t,e,n,l=Math.min(a.length,s.length);return c!==_t&&(t=a[0],e=a[l-1],t>e&&(n=t,t=e,e=n),c=function(n){return Math.max(t,Math.min(e,n))}),i=l>2?mt:pt,r=o=null,h}function h(e){return isNaN(e=+e)?n:(r||(r=i(a.map(t),s,l)))(t(c(e)))}return h.invert=function(n){return c(e((o||(o=i(s,a.map(t),X)))(n)))},h.domain=function(t){return arguments.length?(a=Array.from(t,ht),u()):a.slice()},h.range=function(t){return arguments.length?(s=Array.from(t),u()):s.slice()},h.rangeRound=function(t){return s=Array.from(t),l=tt,u()},h.clamp=function(t){return arguments.length?(c=!!t||_t,u()):c!==_t},h.interpolate=function(t){return arguments.length?(l=t,u()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,i){return t=n,e=i,u()}}function vt(){return yt()(_t,_t)}function wt(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+t.slice(n+1)]}function xt(t){return(t=wt(Math.abs(t)))?t[1]:NaN}var bt,kt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function At(t){if(!(e=kt.exec(t)))throw new Error("invalid format: "+t);var e;return new Mt({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Mt(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function Et(t,e){var n=wt(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}At.prototype=Mt.prototype,Mt.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var St={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Et(100*t,e)},r:Et,s:function(t,e){var n=wt(t,e);if(!n)return t+"";var i=n[0],r=n[1],o=r-(bt=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,a=i.length;return o===a?i:o>a?i+new Array(o-a+1).join("0"):o>0?i.slice(0,o)+"."+i.slice(o):"0."+new Array(1-o).join("0")+wt(t,Math.max(0,e+o-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function Tt(t){return t}var Nt,Lt,$t,jt=Array.prototype.map,Ht=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Ct(t){var e,n,i=void 0===t.grouping||void 0===t.thousands?Tt:(e=jt.call(t.grouping,Number),n=t.thousands+"",function(t,i){for(var r=t.length,o=[],a=0,s=e[0],l=0;r>0&&s>0&&(l+s+1>i&&(s=Math.max(1,i-l)),o.push(t.substring(r-=s,r+s)),!((l+=s+1)>i));)s=e[a=(a+1)%e.length];return o.reverse().join(n)}),r=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",a=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Tt:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(jt.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",c=void 0===t.minus?"-":t.minus+"",u=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=At(t)).fill,n=t.align,h=t.sign,d=t.symbol,_=t.zero,f=t.width,p=t.comma,m=t.precision,g=t.trim,y=t.type;"n"===y?(p=!0,y="g"):St[y]||(void 0===m&&(m=12),g=!0,y="g"),(_||"0"===e&&"="===n)&&(_=!0,e="0",n="=");var v="$"===d?r:"#"===d&&/[boxX]/.test(y)?"0"+y.toLowerCase():"",w="$"===d?o:/[%p]/.test(y)?l:"",x=St[y],b=/[defgprs%]/.test(y);function k(t){var r,o,l,d=v,k=w;if("c"===y)k=x(t)+k,t="";else{var A=(t=+t)<0||1/t<0;if(t=isNaN(t)?u:x(Math.abs(t),m),g&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(!+t[i])break t;r>0&&(r=0)}return r>0?t.slice(0,r)+t.slice(e+1):t}(t)),A&&0==+t&&"+"!==h&&(A=!1),d=(A?"("===h?h:c:"-"===h||"("===h?"":h)+d,k=("s"===y?Ht[8+bt/3]:"")+k+(A&&"("===h?")":""),b)for(r=-1,o=t.length;++r<o;)if(48>(l=t.charCodeAt(r))||l>57){k=(46===l?a+t.slice(r+1):t.slice(r))+k,t=t.slice(0,r);break}}p&&!_&&(t=i(t,1/0));var M=d.length+t.length+k.length,E=M<f?new Array(f-M+1).join(e):"";switch(p&&_&&(t=i(E+t,E.length?f-k.length:1/0),E=""),n){case"<":t=d+t+k+E;break;case"=":t=d+E+t+k;break;case"^":t=E.slice(0,M=E.length>>1)+d+t+k+E.slice(M);break;default:t=E+d+t+k}return s(t)}return m=void 0===m?6:/[gprs]/.test(y)?Math.max(1,Math.min(21,m)):Math.max(0,Math.min(20,m)),k.toString=function(){return t+""},k}return{format:h,formatPrefix:function(t,e){var n=h(((t=At(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(xt(e)/3))),r=Math.pow(10,-i),o=Ht[8+i/3];return function(t){return n(r*t)+o}}}}function It(t,e,n,i){var r,l=function(t,e,n){var i=Math.abs(e-t)/Math.max(0,n),r=Math.pow(10,Math.floor(Math.log(i)/Math.LN10)),l=i/r;return l>=o?r*=10:l>=a?r*=5:l>=s&&(r*=2),e<t?-r:r}(t,e,n);switch((i=At(null==i?",f":i)).type){case"s":var c=Math.max(Math.abs(t),Math.abs(e));return null!=i.precision||isNaN(r=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(xt(e)/3)))-xt(Math.abs(t)))}(l,c))||(i.precision=r),$t(i,c);case"":case"e":case"g":case"p":case"r":null!=i.precision||isNaN(r=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,xt(e)-xt(t))+1}(l,Math.max(Math.abs(t),Math.abs(e))))||(i.precision=r-("e"===i.type));break;case"f":case"%":null!=i.precision||isNaN(r=function(t){return Math.max(0,-xt(Math.abs(t)))}(l))||(i.precision=r-2*("%"===i.type))}return Lt(i)}function Ft(t){var e=t.domain;return t.ticks=function(t){var n=e();return function(t,e,n){var i,r,o,a,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(a=l(t,e,n))||!isFinite(a))return[];if(a>0)for(t=Math.ceil(t/a),e=Math.floor(e/a),o=new Array(r=Math.ceil(e-t+1));++s<r;)o[s]=(t+s)*a;else for(t=Math.floor(t*a),e=Math.ceil(e*a),o=new Array(r=Math.ceil(t-e+1));++s<r;)o[s]=(t-s)/a;return i&&o.reverse(),o}(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var i=e();return It(i[0],i[i.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var i,r=e(),o=0,a=r.length-1,s=r[o],c=r[a];return c<s&&(i=s,s=c,c=i,i=o,o=a,a=i),(i=l(s,c,n))>0?i=l(s=Math.floor(s/i)*i,c=Math.ceil(c/i)*i,n):i<0&&(i=l(s=Math.ceil(s*i)/i,c=Math.floor(c*i)/i,n)),i>0?(r[o]=Math.floor(s/i)*i,r[a]=Math.ceil(c/i)*i,e(r)):i<0&&(r[o]=Math.ceil(s*i)/i,r[a]=Math.floor(c*i)/i,e(r)),t},t}Nt=Ct({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),Lt=Nt.format,$t=Nt.formatPrefix;var Pt="http://www.w3.org/1999/xhtml",Bt={svg:"http://www.w3.org/2000/svg",xhtml:Pt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Dt(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Bt.hasOwnProperty(e)?{space:Bt[e],local:t}:t}function qt(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Pt&&e.documentElement.namespaceURI===Pt?e.createElement(t):e.createElementNS(n,t)}}function Yt(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Wt(t){var e=Dt(t);return(e.local?Yt:qt)(e)}function zt(){}function Ot(t){return null==t?zt:function(){return this.querySelector(t)}}function Rt(){return[]}function Gt(t){return null==t?Rt:function(){return this.querySelectorAll(t)}}function Vt(t){return function(){return this.matches(t)}}function Xt(t){return new Array(t.length)}function Ut(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Ut.prototype={constructor:Ut,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Zt(t,e,n,i,r,o){for(var a,s=0,l=e.length,c=o.length;s<c;++s)(a=e[s])?(a.__data__=o[s],i[s]=a):n[s]=new Ut(t,o[s]);for(;s<l;++s)(a=e[s])&&(r[s]=a)}function Kt(t,e,n,i,r,o,a){var s,l,c,u={},h=e.length,d=o.length,_=new Array(h);for(s=0;s<h;++s)(l=e[s])&&(_[s]=c="$"+a.call(l,l.__data__,s,e),c in u?r[s]=l:u[c]=l);for(s=0;s<d;++s)(l=u[c="$"+a.call(t,o[s],s,o)])?(i[s]=l,l.__data__=o[s],u[c]=null):n[s]=new Ut(t,o[s]);for(s=0;s<h;++s)(l=e[s])&&u[_[s]]===l&&(r[s]=l)}function Qt(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Jt(t){return function(){this.removeAttribute(t)}}function te(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ee(t,e){return function(){this.setAttribute(t,e)}}function ne(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ie(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function re(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function oe(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ae(t){return function(){this.style.removeProperty(t)}}function se(t,e,n){return function(){this.style.setProperty(t,e,n)}}function le(t,e,n){return function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function ce(t,e){return t.style.getPropertyValue(e)||oe(t).getComputedStyle(t,null).getPropertyValue(e)}function ue(t){return function(){delete this[t]}}function he(t,e){return function(){this[t]=e}}function de(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function _e(t){return t.trim().split(/^|\s+/)}function fe(t){return t.classList||new pe(t)}function pe(t){this._node=t,this._names=_e(t.getAttribute("class")||"")}function me(t,e){for(var n=fe(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function ge(t,e){for(var n=fe(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function ye(t){return function(){me(this,t)}}function ve(t){return function(){ge(this,t)}}function we(t,e){return function(){(e.apply(this,arguments)?me:ge)(this,t)}}function xe(){this.textContent=""}function be(t){return function(){this.textContent=t}}function ke(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function Ae(){this.innerHTML=""}function Me(t){return function(){this.innerHTML=t}}function Ee(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Se(){this.nextSibling&&this.parentNode.appendChild(this)}function Te(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ne(){return null}function Le(){var t=this.parentNode;t&&t.removeChild(this)}function $e(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function je(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}pe.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var He={},Ce=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(He={mouseenter:"mouseover",mouseleave:"mouseout"}));function Ie(t,e,n){return t=Fe(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Fe(t,e,n){return function(i){var r=Ce;Ce=i;try{t.call(this,this.__data__,e,n)}finally{Ce=r}}}function Pe(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function Be(t){return function(){var e=this.__on;if(e){for(var n,i=0,r=-1,o=e.length;i<o;++i)n=e[i],t.type&&n.type!==t.type||n.name!==t.name?e[++r]=n:this.removeEventListener(n.type,n.listener,n.capture);++r?e.length=r:delete this.__on}}}function De(t,e,n){var i=He.hasOwnProperty(t.type)?Ie:Fe;return function(r,o,a){var s,l=this.__on,c=i(e,o,a);if(l)for(var u=0,h=l.length;u<h;++u)if((s=l[u]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=c,s.capture=n),void(s.value=e);this.addEventListener(t.type,c,n),s={type:t.type,name:t.name,value:e,listener:c,capture:n},l?l.push(s):this.__on=[s]}}function qe(t,e,n){var i=oe(t),r=i.CustomEvent;"function"==typeof r?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function Ye(t,e){return function(){return qe(this,t,e)}}function We(t,e){return function(){return qe(this,t,e.apply(this,arguments))}}var ze=[null];function Oe(t,e){this._groups=t,this._parents=e}function Re(){return new Oe([[document.documentElement]],ze)}function Ge(){for(var t,e=Ce;t=e.sourceEvent;)e=t;return e}Oe.prototype=Re.prototype={constructor:Oe,select:function(t){"function"!=typeof t&&(t=Ot(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a,s=e[r],l=s.length,c=i[r]=new Array(l),u=0;u<l;++u)(o=s[u])&&(a=t.call(o,o.__data__,u,s))&&("__data__"in o&&(a.__data__=o.__data__),c[u]=a);return new Oe(i,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=Gt(t));for(var e=this._groups,n=e.length,i=[],r=[],o=0;o<n;++o)for(var a,s=e[o],l=s.length,c=0;c<l;++c)(a=s[c])&&(i.push(t.call(a,a.__data__,c,s)),r.push(a));return new Oe(i,r)},filter:function(t){"function"!=typeof t&&(t=Vt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,l=i[r]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new Oe(i,this._parents)},data:function(t,e){if(!t)return _=new Array(this.size()),c=-1,this.each((function(t){_[++c]=t})),_;var n=e?Kt:Zt,i=this._parents,r=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=r.length,a=new Array(o),s=new Array(o),l=new Array(o),c=0;c<o;++c){var u=i[c],h=r[c],d=h.length,_=t.call(u,u&&u.__data__,c,i),f=_.length,p=s[c]=new Array(f),m=a[c]=new Array(f);n(u,h,p,m,l[c]=new Array(d),_,e);for(var g,y,v=0,w=0;v<f;++v)if(g=p[v]){for(v>=w&&(w=v+1);!(y=m[w])&&++w<f;);g._next=y||null}}return(a=new Oe(a,i))._enter=s,a._exit=l,a},enter:function(){return new Oe(this._enter||this._groups.map(Xt),this._parents)},exit:function(){return new Oe(this._exit||this._groups.map(Xt),this._parents)},join:function(t,e,n){var i=this.enter(),r=this,o=this.exit();return i="function"==typeof t?t(i):i.append(t+""),null!=e&&(r=e(r)),null==n?o.remove():n(o),i&&r?i.merge(r).order():r},merge:function(t){for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var l,c=e[s],u=n[s],h=c.length,d=a[s]=new Array(h),_=0;_<h;++_)(l=c[_]||u[_])&&(d[_]=l);for(;s<i;++s)a[s]=e[s];return new Oe(a,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i,r=t[e],o=r.length-1,a=r[o];--o>=0;)(i=r[o])&&(a&&4^i.compareDocumentPosition(a)&&a.parentNode.insertBefore(i,a),a=i);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=Qt);for(var n=this._groups,i=n.length,r=new Array(i),o=0;o<i;++o){for(var a,s=n[o],l=s.length,c=r[o]=new Array(l),u=0;u<l;++u)(a=s[u])&&(c[u]=a);c.sort(e)}return new Oe(r,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,o=i.length;r<o;++r){var a=i[r];if(a)return a}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r,o=e[n],a=0,s=o.length;a<s;++a)(r=o[a])&&t.call(r,r.__data__,a,o);return this},attr:function(t,e){var n=Dt(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((null==e?n.local?te:Jt:"function"==typeof e?n.local?re:ie:n.local?ne:ee)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?ae:"function"==typeof e?le:se)(t,e,null==n?"":n)):ce(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?ue:"function"==typeof e?de:he)(t,e)):this.node()[t]},classed:function(t,e){var n=_e(t+"");if(arguments.length<2){for(var i=fe(this.node()),r=-1,o=n.length;++r<o;)if(!i.contains(n[r]))return!1;return!0}return this.each(("function"==typeof e?we:e?ye:ve)(n,e))},text:function(t){return arguments.length?this.each(null==t?xe:("function"==typeof t?ke:be)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?Ae:("function"==typeof t?Ee:Me)(t)):this.node().innerHTML},raise:function(){return this.each(Se)},lower:function(){return this.each(Te)},append:function(t){var e="function"==typeof t?t:Wt(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:Wt(t),i=null==e?Ne:"function"==typeof e?e:Ot(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)}))},remove:function(){return this.each(Le)},clone:function(t){return this.select(t?je:$e)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var i,r,o=Pe(t+""),a=o.length;if(!(arguments.length<2)){for(s=e?De:Be,null==n&&(n=!1),i=0;i<a;++i)this.each(s(o[i],e,n));return this}var s=this.node().__on;if(s)for(var l,c=0,u=s.length;c<u;++c)for(i=0,l=s[c];i<a;++i)if((r=o[i]).type===l.type&&r.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?We:Ye)(t,e))}};var Ve=Math.PI,Xe=2*Ve,Ue=Xe-1e-6;function Ze(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Ke(){return new Ze}function Qe(t){return function(){return t}}function Je(t){this._context=t}function tn(t){return new Je(t)}function en(t){return t[0]}function nn(t){return t[1]}function rn(){var t=en,e=nn,n=Qe(!0),i=null,r=tn,o=null;function a(a){var s,l,c,u=a.length,h=!1;for(null==i&&(o=r(c=Ke())),s=0;s<=u;++s)!(s<u&&n(l=a[s],s,a))===h&&((h=!h)?o.lineStart():o.lineEnd()),h&&o.point(+t(l,s,a),+e(l,s,a));if(c)return o=null,c+""||null}return a.x=function(e){return arguments.length?(t="function"==typeof e?e:Qe(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:Qe(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:Qe(!!t),a):n},a.curve=function(t){return arguments.length?(r=t,null!=i&&(o=r(i)),a):r},a.context=function(t){return arguments.length?(null==t?i=o=null:o=r(i=t),a):i},a}function on(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function an(t){this._context=t}Ze.prototype=Ke.prototype={constructor:Ze,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+o)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var o=this._x1,a=this._y1,s=n-t,l=i-e,c=o-t,u=a-e,h=c*c+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(u*s-l*c)>1e-6&&r){var d=n-o,_=i-a,f=s*s+l*l,p=d*d+_*_,m=Math.sqrt(f),g=Math.sqrt(h),y=r*Math.tan((Ve-Math.acos((f+h-p)/(2*m*g)))/2),v=y/g,w=y/m;Math.abs(v-1)>1e-6&&(this._+="L"+(t+v*c)+","+(e+v*u)),this._+="A"+r+","+r+",0,0,"+ +(u*d>c*_)+","+(this._x1=t+w*s)+","+(this._y1=e+w*l)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,o){t=+t,e=+e,o=!!o;var a=(n=+n)*Math.cos(i),s=n*Math.sin(i),l=t+a,c=e+s,u=1^o,h=o?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%Xe+Xe),h>Ue?this._+="A"+n+","+n+",0,1,"+u+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=l)+","+(this._y1=c):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Ve)+","+u+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}},Je.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},an.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:on(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:on(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var sn={value:function(){}};function ln(){for(var t,e=0,n=arguments.length,i={};e<n;++e){if(!(t=arguments[e]+"")||t in i||/[\s.]/.test(t))throw new Error("illegal type: "+t);i[t]=[]}return new cn(i)}function cn(t){this._=t}function un(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",i=t.indexOf(".");if(i>=0&&(n=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function hn(t,e){for(var n,i=0,r=t.length;i<r;++i)if((n=t[i]).name===e)return n.value}function dn(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=sn,t=t.slice(0,i).concat(t.slice(i+1));break}return null!=n&&t.push({name:e,value:n}),t}cn.prototype=ln.prototype={constructor:cn,on:function(t,e){var n,i=this._,r=un(t+"",i),o=-1,a=r.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<a;)if(n=(t=r[o]).type)i[n]=dn(i[n],t.name,e);else if(null==e)for(n in i)i[n]=dn(i[n],t.name,null);return this}for(;++o<a;)if((n=(t=r[o]).type)&&(n=hn(i[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new cn(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,i,r=new Array(n),o=0;o<n;++o)r[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(i=this._[t]).length;o<n;++o)i[o].value.apply(e,r)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(e,n)}};var _n,fn,pn=0,mn=0,gn=0,yn=0,vn=0,wn=0,xn="object"==typeof performance&&performance.now?performance:Date,bn="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function kn(){return vn||(bn(An),vn=xn.now()+wn)}function An(){vn=0}function Mn(){this._call=this._time=this._next=null}function En(t,e,n){var i=new Mn;return i.restart(t,e,n),i}function Sn(){vn=(yn=xn.now())+wn,pn=mn=0;try{!function(){kn(),++pn;for(var t,e=_n;e;)(t=vn-e._time)>=0&&e._call.call(null,t),e=e._next;--pn}()}finally{pn=0,function(){var t,e,n=_n,i=1/0;for(;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:_n=e);fn=t,Nn(i)}(),vn=0}}function Tn(){var t=xn.now(),e=t-yn;e>1e3&&(wn-=e,yn=t)}function Nn(t){pn||(mn&&(mn=clearTimeout(mn)),t-vn>24?(t<1/0&&(mn=setTimeout(Sn,t-xn.now()-wn)),gn&&(gn=clearInterval(gn))):(gn||(yn=xn.now(),gn=setInterval(Tn,1e3)),pn=1,bn(Sn)))}function Ln(t,e,n){var i=new Mn;return e=null==e?0:+e,i.restart((function(n){i.stop(),t(n+e)}),e,n),i}Mn.prototype=En.prototype={constructor:Mn,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?kn():+n)+(null==e?0:+e),this._next||fn===this||(fn?fn._next=this:_n=this,fn=this),this._call=t,this._time=n,Nn()},stop:function(){this._call&&(this._call=null,this._time=1/0,Nn())}};var $n=ln("start","end","cancel","interrupt"),jn=[];function Hn(t,e,n,i,r,o){var a=t.__transition;if(a){if(n in a)return}else t.__transition={};!function(t,e,n){var i,r=t.__transition;function o(l){var c,u,h,d;if(1!==n.state)return s();for(c in r)if((d=r[c]).name===n.name){if(3===d.state)return Ln(o);4===d.state?(d.state=6,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[c]):+c<e&&(d.state=6,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[c])}if(Ln((function(){3===n.state&&(n.state=4,n.timer.restart(a,n.delay,n.time),a(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(h=n.tween.length),c=0,u=-1;c<h;++c)(d=n.tween[c].value.call(t,t.__data__,n.index,n.group))&&(i[++u]=d);i.length=u+1}}function a(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),o=-1,a=i.length;++o<a;)i[o].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var i in n.state=6,n.timer.stop(),delete r[e],r)return;delete t.__transition}r[e]=n,n.timer=En((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:i,group:r,on:$n,tween:jn,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:0})}function Cn(t,e){var n=Fn(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function In(t,e){var n=Fn(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Fn(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function Pn(t,e){var n,i;return function(){var r=In(this,t),o=r.tween;if(o!==n)for(var a=0,s=(i=n=o).length;a<s;++a)if(i[a].name===e){(i=i.slice()).splice(a,1);break}r.tween=i}}function Bn(t,e,n){var i,r;if("function"!=typeof n)throw new Error;return function(){var o=In(this,t),a=o.tween;if(a!==i){r=(i=a).slice();for(var s={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=s;break}l===c&&r.push(s)}o.tween=r}}function Dn(t,e,n){var i=t._id;return t.each((function(){var t=In(this,i);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Fn(t,i).value[e]}}function qn(t,e){var n;return("number"==typeof e?X:e instanceof S?z:(n=S(e))?(e=n,z):Q)(t,e)}function Yn(t){return function(){this.removeAttribute(t)}}function Wn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zn(t,e,n){var i,r,o=n+"";return function(){var a=this.getAttribute(t);return a===o?null:a===i?r:r=e(i=a,n)}}function On(t,e,n){var i,r,o=n+"";return function(){var a=this.getAttributeNS(t.space,t.local);return a===o?null:a===i?r:r=e(i=a,n)}}function Rn(t,e,n){var i,r,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttribute(t))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=e(i=a,l));this.removeAttribute(t)}}function Gn(t,e,n){var i,r,o;return function(){var a,s,l=n(this);if(null!=l)return(a=this.getAttributeNS(t.space,t.local))===(s=l+"")?null:a===i&&s===r?o:(r=s,o=e(i=a,l));this.removeAttributeNS(t.space,t.local)}}function Vn(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Xn(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Un(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Xn(t,r)),n}return r._value=e,r}function Zn(t,e){var n,i;function r(){var r=e.apply(this,arguments);return r!==i&&(n=(i=r)&&Vn(t,r)),n}return r._value=e,r}function Kn(t,e){return function(){Cn(this,t).delay=+e.apply(this,arguments)}}function Qn(t,e){return e=+e,function(){Cn(this,t).delay=e}}function Jn(t,e){return function(){In(this,t).duration=+e.apply(this,arguments)}}function ti(t,e){return e=+e,function(){In(this,t).duration=e}}function ei(t,e){if("function"!=typeof e)throw new Error;return function(){In(this,t).ease=e}}function ni(t,e,n){var i,r,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?Cn:In;return function(){var a=o(this,t),s=a.on;s!==i&&(r=(i=s).copy()).on(e,n),a.on=r}}var ii=Re.prototype.constructor;function ri(t){return function(){this.style.removeProperty(t)}}function oi(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function ai(t,e,n){var i,r;function o(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&oi(t,o,n)),i}return o._value=e,o}function si(t){return function(e){this.textContent=t.call(this,e)}}function li(t){var e,n;function i(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&si(i)),e}return i._value=t,i}var ci=0;function ui(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function hi(t){return Re().transition(t)}function di(){return++ci}var _i=Re.prototype;ui.prototype=hi.prototype={constructor:ui,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Ot(t));for(var i=this._groups,r=i.length,o=new Array(r),a=0;a<r;++a)for(var s,l,c=i[a],u=c.length,h=o[a]=new Array(u),d=0;d<u;++d)(s=c[d])&&(l=t.call(s,s.__data__,d,c))&&("__data__"in s&&(l.__data__=s.__data__),h[d]=l,Hn(h[d],e,n,d,h,Fn(s,n)));return new ui(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Gt(t));for(var i=this._groups,r=i.length,o=[],a=[],s=0;s<r;++s)for(var l,c=i[s],u=c.length,h=0;h<u;++h)if(l=c[h]){for(var d,_=t.call(l,l.__data__,h,c),f=Fn(l,n),p=0,m=_.length;p<m;++p)(d=_[p])&&Hn(d,e,n,p,_,f);o.push(_),a.push(l)}return new ui(o,a,e,n)},filter:function(t){"function"!=typeof t&&(t=Vt(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var o,a=e[r],s=a.length,l=i[r]=[],c=0;c<s;++c)(o=a[c])&&t.call(o,o.__data__,c,a)&&l.push(o);return new ui(i,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,o=Math.min(i,r),a=new Array(i),s=0;s<o;++s)for(var l,c=e[s],u=n[s],h=c.length,d=a[s]=new Array(h),_=0;_<h;++_)(l=c[_]||u[_])&&(d[_]=l);for(;s<i;++s)a[s]=e[s];return new ui(a,this._parents,this._name,this._id)},selection:function(){return new ii(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=di(),i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,c=0;c<l;++c)if(a=s[c]){var u=Fn(a,e);Hn(a,t,n,c,s,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new ui(i,this._parents,t,n)},call:_i.call,nodes:_i.nodes,node:_i.node,size:_i.size,empty:_i.empty,each:_i.each,on:function(t,e){var n=this._id;return arguments.length<2?Fn(this.node(),n).on.on(t):this.each(ni(n,t,e))},attr:function(t,e){var n=Dt(t),i="transform"===n?ut:qn;return this.attrTween(t,"function"==typeof e?(n.local?Gn:Rn)(n,i,Dn(this,"attr."+t,e)):null==e?(n.local?Wn:Yn)(n):(n.local?On:zn)(n,i,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var i=Dt(t);return this.tween(n,(i.local?Un:Zn)(i,e))},style:function(t,e,n){var i="transform"==(t+="")?ct:qn;return null==e?this.styleTween(t,function(t,e){var n,i,r;return function(){var o=ce(this,t),a=(this.style.removeProperty(t),ce(this,t));return o===a?null:o===n&&a===i?r:r=e(n=o,i=a)}}(t,i)).on("end.style."+t,ri(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var i,r,o;return function(){var a=ce(this,t),s=n(this),l=s+"";return null==s&&(this.style.removeProperty(t),l=s=ce(this,t)),a===l?null:a===i&&l===r?o:(r=l,o=e(i=a,s))}}(t,i,Dn(this,"style."+t,e))).each(function(t,e){var n,i,r,o,a="style."+e,s="end."+a;return function(){var l=In(this,t),c=l.on,u=null==l.value[a]?o||(o=ri(e)):void 0;c===n&&r===u||(i=(n=c).copy()).on(s,r=u),l.on=i}}(this._id,t)):this.styleTween(t,function(t,e,n){var i,r,o=n+"";return function(){var a=ce(this,t);return a===o?null:a===i?r:r=e(i=a,n)}}(t,i,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(null==e)return this.tween(i,null);if("function"!=typeof e)throw new Error;return this.tween(i,ai(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(Dn(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,li(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i,r=Fn(this.node(),n).tween,o=0,a=r.length;o<a;++o)if((i=r[o]).name===t)return i.value;return null}return this.each((null==e?Pn:Bn)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Kn:Qn)(e,t)):Fn(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Jn:ti)(e,t)):Fn(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(ei(e,t)):Fn(this.node(),e).ease},end:function(){var t,e,n=this,i=n._id,r=n.size();return new Promise((function(o,a){var s={value:a},l={value:function(){0==--r&&o()}};n.each((function(){var n=In(this,i),r=n.on;r!==t&&((e=(t=r).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(l)),n.on=e}))}))}};var fi={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function pi(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return fi.time=kn(),fi;return n}Re.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,i,r,o=t.__transition,a=!0;if(o){for(r in e=null==e?null:e+"",o)(n=o[r]).name===e?(i=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(i?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[r]):a=!1;a&&delete t.__transition}}(this,t)}))},Re.prototype.transition=function(t){var e,n;t instanceof ui?(e=t._id,t=t._name):(e=di(),(n=fi).time=kn(),t=null==t?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var a,s=i[o],l=s.length,c=0;c<l;++c)(a=s[c])&&Hn(a,t,e,c,s,n||pi(a,e));return new ui(i,this._parents,t,e)};var mi=Array.prototype.slice;function gi(t){return t}function yi(t){return"translate("+(t+.5)+",0)"}function vi(t){return"translate(0,"+(t+.5)+")"}function wi(t){return function(e){return+t(e)}}function xi(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function bi(){return!this.__axis}function ki(t,e){var n=[],i=null,r=null,o=6,a=6,s=3,l=1===t||4===t?-1:1,c=4===t||2===t?"x":"y",u=1===t||3===t?yi:vi;function h(h){var d=null==i?e.ticks?e.ticks.apply(e,n):e.domain():i,_=null==r?e.tickFormat?e.tickFormat.apply(e,n):gi:r,f=Math.max(o,0)+s,p=e.range(),m=+p[0]+.5,g=+p[p.length-1]+.5,y=(e.bandwidth?xi:wi)(e.copy()),v=h.selection?h.selection():h,w=v.selectAll(".domain").data([null]),x=v.selectAll(".tick").data(d,e).order(),b=x.exit(),k=x.enter().append("g").attr("class","tick"),A=x.select("line"),M=x.select("text");w=w.merge(w.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(k),A=A.merge(k.append("line").attr("stroke","currentColor").attr(c+"2",l*o)),M=M.merge(k.append("text").attr("fill","currentColor").attr(c,l*f).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==v&&(w=w.transition(h),x=x.transition(h),A=A.transition(h),M=M.transition(h),b=b.transition(h).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=y(t))?u(t):this.getAttribute("transform")})),k.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return u(e&&isFinite(e=e(t))?e:y(t))}))),b.remove(),w.attr("d",4===t||2==t?a?"M"+l*a+","+m+"H0.5V"+g+"H"+l*a:"M0.5,"+m+"V"+g:a?"M"+m+","+l*a+"V0.5H"+g+"V"+l*a:"M"+m+",0.5H"+g),x.attr("opacity",1).attr("transform",(function(t){return u(y(t))})),A.attr(c+"2",l*o),M.attr(c,l*f).text(_),v.filter(bi).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),v.each((function(){this.__axis=y}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=mi.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:mi.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(i=null==t?null:mi.call(t),h):i&&i.slice()},h.tickFormat=function(t){return arguments.length?(r=t,h):r},h.tickSize=function(t){return arguments.length?(o=a=+t,h):o},h.tickSizeInner=function(t){return arguments.length?(o=+t,h):o},h.tickSizeOuter=function(t){return arguments.length?(a=+t,h):a},h.tickPadding=function(t){return arguments.length?(s=+t,h):s},h}function Ai(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}return t.area=function(){var t=en,e=null,n=Qe(0),i=nn,r=Qe(!0),o=null,a=tn,s=null;function l(l){var c,u,h,d,_,f=l.length,p=!1,m=new Array(f),g=new Array(f);for(null==o&&(s=a(_=Ke())),c=0;c<=f;++c){if(!(c<f&&r(d=l[c],c,l))===p)if(p=!p)u=c,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=c-1;h>=u;--h)s.point(m[h],g[h]);s.lineEnd(),s.areaEnd()}p&&(m[c]=+t(d,c,l),g[c]=+n(d,c,l),s.point(e?+e(d,c,l):m[c],i?+i(d,c,l):g[c]))}if(_)return s=null,_+""||null}function c(){return rn().defined(r).curve(a).context(o)}return l.x=function(n){return arguments.length?(t="function"==typeof n?n:Qe(+n),e=null,l):t},l.x0=function(e){return arguments.length?(t="function"==typeof e?e:Qe(+e),l):t},l.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:Qe(+t),l):e},l.y=function(t){return arguments.length?(n="function"==typeof t?t:Qe(+t),i=null,l):n},l.y0=function(t){return arguments.length?(n="function"==typeof t?t:Qe(+t),l):n},l.y1=function(t){return arguments.length?(i=null==t?null:"function"==typeof t?t:Qe(+t),l):i},l.lineX0=l.lineY0=function(){return c().x(t).y(n)},l.lineY1=function(){return c().x(t).y(i)},l.lineX1=function(){return c().x(e).y(n)},l.defined=function(t){return arguments.length?(r="function"==typeof t?t:Qe(!!t),l):r},l.curve=function(t){return arguments.length?(a=t,null!=o&&(s=a(o)),l):a},l.context=function(t){return arguments.length?(null==t?o=s=null:s=a(o=t),l):o},l},t.axisBottom=function(t){return ki(3,t)},t.axisLeft=function(t){return ki(4,t)},t.curveBasis=function(t){return new an(t)},t.easeLinear=function(t){return+t},t.interpolateArray=function(t,e){return(R(e)?O:G)(t,e)},t.interpolateNumber=X,t.json=function(t,e){return fetch(t,e).then(Ai)},t.line=rn,t.max=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n<r||void 0===n&&r>=r)&&(n=r)}return n},t.min=function(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let i=-1;for(let r of t)null!=(r=e(r,++i,t))&&(n>r||void 0===n&&r>=r)&&(n=r)}return n},t.mouse=function(t){var e=Ge();return e.changedTouches&&(e=e.changedTouches[0]),function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,[(i=i.matrixTransform(t.getScreenCTM().inverse())).x,i.y]}var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}(t,e)},t.scaleLinear=function t(){var e=vt();return e.copy=function(){return gt(e,t())},c.apply(e,arguments),Ft(e)},t.scaleOrdinal=function t(){var e=new Map,n=[],i=[],r=u;function o(t){var o=t+"",a=e.get(o);if(!a){if(r!==u)return r;e.set(o,a=n.push(t))}return i[(a-1)%i.length]}return o.domain=function(t){if(!arguments.length)return n.slice();n=[],e=new Map;for(const i of t){const t=i+"";e.has(t)||e.set(t,n.push(i))}return o},o.range=function(t){return arguments.length?(i=Array.from(t),o):i.slice()},o.unknown=function(t){return arguments.length?(r=t,o):r},o.copy=function(){return t(n,i).unknown(r)},c.apply(o,arguments),o},t.scaleThreshold=function t(){var e,n=[.5],i=[0,1],o=1;function a(t){return t<=t?i[r(n,t,0,o)]:e}return a.domain=function(t){return arguments.length?(n=Array.from(t),o=Math.min(n.length,i.length-1),a):n.slice()},a.range=function(t){return arguments.length?(i=Array.from(t),o=Math.min(n.length,i.length-1),a):i.slice()},a.invertExtent=function(t){var e=i.indexOf(t);return[n[e-1],n[e]]},a.unknown=function(t){return arguments.length?(e=t,a):e},a.copy=function(){return t().domain(n).range(i).unknown(e)},c.apply(a,arguments)},t.select=function(t){return"string"==typeof t?new Oe([[document.querySelector(t)]],[document.documentElement]):new Oe([[t]],ze)},t.selectAll=function(t){return"string"==typeof t?new Oe([document.querySelectorAll(t)],[document.documentElement]):new Oe([null==t?[]:t],ze)},t.transition=hi,t}({});function setHeight(t=!1){const e=window.matchMedia("(max-width: 1050px), (max-height:625px)").matches;is_small!=e&&(t&&(is_small?(d3.select("#toolbar").style("left","calc(100% - 323px)"),d3.select("#icon-wrapper").style("left","calc(100% - 323px)")):(is_expanded=!0,toggleToolbar(0))),is_small=e,years_distance=is_small?48:65,years_lower=48*years_distance,years_upper=49*years_distance,scroll_limit=years_lower),t||(is_expanded=is_small)}function toolbarChanges(){has_toolbar!=(d3.select("#percent").style("height")!=d3.select("#vh").style("height"))&&(has_toolbar=!has_toolbar,content_obj=has_toolbar?document.getElementById("content"):document.documentElement,has_toolbar?(d3.select(window).on("scroll.scroller",null),d3.select("#content").on("scroll.scroller",globalInterpolate),d3.select("body").style("overflow","hidden"),d3.select("#content").style("position","fixed").style("overflow-y","scroll"),has_mouse&&d3.select("#density-div").on("wheel",(function(){d3.select("#density-div").style("pointer-events","none"),wheel_timeout&&clearTimeout(wheel_timeout),wheel_timeout=setTimeout((function(){d3.select("#density-div").style("pointer-events","initial")}),250)}))):(d3.select("#content").on("scroll.scroller",null),d3.select("body").style("overflow","initial"),d3.select("#content").style("position","initial").style("overflow-y","initial"),d3.select(window).on("scroll.scroller",globalInterpolate),has_mouse&&d3.select("#density-div").on("wheel",null)))}function tickFunction(t){return`$${Math.round(t/1e3).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}K`}async function simpleUpdate(t,e){is_transitioning=!0,animation_timeout&&clearTimeout(animation_timeout);let n=!0;t!=animations_filenames[0]&&(animations_dict[0]=new IncomeAnimation(0,await d3.json(t)),shown_distributions[0]=!1,animations_filenames[0]=t),e!=animations_filenames[1]&&(animations_dict[1]=null!=e?new IncomeAnimation(1,await d3.json(e)):void 0,shown_distributions[1]=!1,animations_filenames[1]=e),makeUpperStrings();const[i,r]=[global_x_max,global_y_max],o=x_scale;setGlobalMaxes(),i!=global_x_max||r!=global_y_max?makeScales():n=!1,r!=global_y_max&&makeConstantScales(),i!=global_x_max&&(scaled_global_thresholds=global_thresholds.map(t=>x_scale(t))),shown_distributions[0]&&animations_dict[0].makeInterpolatingDictionaries(),shown_distributions[1]&&animations_dict[1].makeInterpolatingDictionaries(),n?animateTransition(o):finishTransition()}function animateTransition(t){updateAxes(),updateDensityGridLines(t),shown_distributions[0]&&updateDensityPlotClipPathVerticalLines(0),shown_distributions[1]&&updateDensityPlotClipPathVerticalLines(1),animation_timeout=setTimeout(finishTransition,525)}function updateDensityPlotClipPathVerticalLines(t){const[e,n]=animations_dict[t].interpolate();density_svg_dict[t].selectAll(".curve-"+t).datum(e).transition().duration(500).attr("d",(t,e)=>curveFunction(t,e)),animations_dict[t].clip_path.datum(e).transition().duration(500).attr("d",(t,e)=>clipFunction(t,e)),lines_svg_dict[t].selectAll(".vertical-line-"+t).data(n).transition().duration(500).attr("x1",t=>x_scale(t)).attr("x2",t=>x_scale(t))}function updateDensityGridLines(t){const e=grid_svg.selectAll(".grid-line").data(x_scale.ticks(num_x_ticks).slice(1),t=>t);e.enter().append("line").attr("class","grid-line").attr("y1",scaled_top).attr("y2",scaled_bottom).attr("x1",e=>t(e)).attr("x2",e=>t(e)).style("opacity",0).merge(e).transition().duration(500).attr("x1",t=>x_scale(t)).attr("x2",t=>x_scale(t)).style("opacity",.1),e.exit().transition().duration(500).style("opacity",0).attr("x1",t=>x_scale(t)).attr("x2",t=>x_scale(t)).remove()}function drawGroup(t){animations_dict[t].readyAnimation(),drawLinesAndDots(animations_dict[t].data_obj.incomes_dict,t)}function redrawGroup(t){animations_dict[t].makeInterpolatingDictionaries(),animations_dict[t].redraw()}function finishTransition(){cutAndScaleThresholds(),updateYearsGridLines(x_scale.ticks(num_x_ticks).slice(1)),animations_filenames[0]&&finishGroup(0),animations_filenames[1]&&finishGroup(1),wrapper_with_adjusted_margins.selectAll(".hidden").classed("hidden",!1),yearsLinesEventListeners(),is_transitioning=!1}function finishGroup(t){updateYearsLines(t),shown_distributions[t]?redrawGroup(t):drawGroup(t),shown_distributions[t]=!0}function setGlobalMaxes(){if(animations_dict[1]){const t=d3.max([animations_dict[0].data_obj.x_max,animations_dict[1].data_obj.x_max])+3e4;return void([global_x_max,global_y_max]=[t-t%2e3,d3.max([animations_dict[0].data_obj.y_max,animations_dict[1].data_obj.y_max])])}const t=animations_dict[0].data_obj.x_max+3e4;[global_x_max,global_y_max]=[t-t%2e3,animations_dict[0].data_obj.y_max]}function removeGroup(t){wrapper_with_adjusted_margins.selectAll(".density-group-"+t).remove(),years_svg.selectAll(".years-line-"+t).remove()}function drawLinesAndDots(t,e){years_svg.selectAll(".year-plots-"+e).data(t).enter().append("g").append("path").attr("d",t=>line_function(t.vals)).attr("class",(t,n)=>"year-info years-line years-line-"+e+(n==animations_dict[0].num_lines-1?" background-line":"")).attr("id",t=>`years-line-${e}-${t.name}`),years_svg.append("path").attr("d",line_function(t[animations_dict[0].num_lines-1].vals)).attr("class",`year-info years-line years-line-${e} average-line`).attr("id",t=>`years-line-${e}-${animations_dict[0].num_lines}`)}function makeYearsSvg(){years_svg_wrapper=d3.select("#background-years").append("svg").attr("id","years-svg").attr("width","100%").attr("height","100%"),years_svg=years_svg_wrapper.append("g").attr("transform","translate("+margins.left+",0)")}function makeYearsGridLines(){const t=years_lower+years_line_height;years_svg.selectAll(".years-grid-line").data(x_scale.ticks(num_x_ticks).slice(1)).enter().append("line").attr("class","year-info years-grid-line hidden").attr("x1",t=>years_x_scale(t)).attr("x2",t=>years_x_scale(t)).attr("y1",years_line_height).attr("y2",t)}function makeYearsInfo(){line_function=d3.line().x((function(t){return years_x_scale(t)})).y((function(t,e){return years_y_scale(e)}));const t=scaled_global_thresholds[global_num_thresholds-1],e=x_scale(0);for(let n=0;n<49;n++){let i=years_y_scale(n);years_svg.append("line").attr("y1",i).attr("y2",i).attr("x1",e).attr("x2",t).attr("class","hidden year-line year-info"),years_svg_wrapper.append("text").attr("y",i).attr("x",margins.left-12).attr("class","hidden year-text year-info").attr("dominant-baseline","central").text(String(n+1970))}makeYearsGridLines(),drawLinesAndDots(animations_dict[0].data_obj.incomes_dict,0),null!=animations_dict[1]&&drawLinesAndDots(animations_dict[1].data_obj.incomes_dict,1)}function makeYearsTooltips(){const t=+d3.select("#title-div").style("height").slice(0,-2)+45;d3.select("#background-years").selectAll(".years-tooltip").data(new Array(49).fill(-1)).enter().append("div").html("$100,000").attr("class","years-tooltip hidden").style("top",(e,n)=>years_y_scale(n)+t+"px"),adjustYearsTooltips()}class IncomeAnimation{constructor(t,e){this.plotting_num=t,this.data_obj=e,this.x_max=e.x_max,this.y_max=e.y_max,this.num_lines=e.incomes_dict.length,this.curve=void 0,this.clip_path=void 0,this.drawing_dictionaries=void 0,this.incomes_dictionaries=void 0,this.interpolated_incomes=void 0,this.hover_indices=[],this.clicked_indices=[],this.is_selected=current_selection==t,this.hover_info=[-1,-1],this.vertical_lines=void 0,this.tooltip_percentile=void 0}readyAnimation(){this.makeInterpolatingDictionaries(),this.initialPlotsAndLines()}makeInterpolatingDictionaries(){const t={},e={},n=num_years-1;for(let i=0;i<n;i++)t[i]=d3.interpolateArray(this.data_obj.densities[i].slice(0,global_num_thresholds).map(t=>y_scale(t)),this.data_obj.densities[i+1].slice(0,global_num_thresholds).map(t=>y_scale(t))),e[i]=d3.interpolateArray(this.data_obj.incomes[i],this.data_obj.incomes[i+1]);t[n]=d3.interpolateArray(this.data_obj.densities[n].slice(0,global_num_thresholds).map(t=>y_scale(t)),this.data_obj.densities[n].slice(0,global_num_thresholds).map(t=>y_scale(t))),e[n]=d3.interpolateArray(this.data_obj.incomes[n],this.data_obj.incomes[n]),this.drawing_dictionaries=t,this.incomes_dictionaries=e}interpolate(){const t=global_scroll_num-global_scroll_floor;return[this.drawing_dictionaries[global_scroll_floor](t),this.incomes_dictionaries[global_scroll_floor](t)]}initialPlotsAndLines(){const[t,e]=this.interpolate();this.interpolated_incomes=e;const n=this;this.curve=density_svg_dict[this.plotting_num].append("path").attr("class",`curve-${this.plotting_num} highlight-class-${this.plotting_num} not-axes density-group-${this.plotting_num} hidden`).datum(t).attr("d",(t,e)=>curveFunction(t,e)),this.clip_path=density_svg_dict[this.plotting_num].append("clipPath").attr("id","clip-path-"+this.plotting_num).attr("class","not-axes density-group-"+this.plotting_num).append("path").datum(t).attr("d",(t,e)=>clipFunction(t,e)),this.vertical_lines=lines_svg_dict[this.plotting_num].selectAll(".vertical-line-"+this.plotting_num).data(this.interpolated_incomes).enter().append("line").attr("class",(t,e)=>`hidden not-axes density-group-${n.plotting_num} vertical-line vertical-line-${n.plotting_num} vertical-line-${n.plotting_num}-${e}`+(e==this.num_lines-1?" average-line":"")).attr("y1",scaled_bottom).attr("y2",scaled_top).attr("x1",t=>x_scale(t)).attr("x2",t=>x_scale(t)).each((t,e)=>{n.clicked_indices.includes(e)&&n.addClickedPercentile(e)})}redraw(){const[t,e]=this.interpolate();this.interpolated_incomes=e,this.curve.datum(t).attr("d",(t,e)=>curveFunction(t,e)),this.clip_path.datum(t).attr("d",(t,e)=>clipFunction(t,e)),this.vertical_lines.data(e).attr("x1",t=>x_scale(t)).attr("x2",t=>x_scale(t)),this.is_selected&bottom_svg_hover?this.highlightClosest():is_hovering_years&&this.showTooltip(this.tooltip_percentile,!1)}showTooltip(t,e){const n=(2*(t+1)).toFixed(0);density_tooltip.html(`<p>${t!=this.num_lines-1?`${n}${"2"==n.slice(-1)?"nd":"th"} percentile`:"Average"}</p>`+(e?`<p>$${this.interpolated_incomes[t].toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")}</p>`:"")).style("left",(this.interpolated_incomes[t]<=this.interpolated_incomes[36]?x_scale(this.interpolated_incomes[t])+margins.left+tooltips_margin:x_scale(this.interpolated_incomes[t])+margins.left-+density_tooltip.style("width").slice(0,-2)-tooltips_margin)+"px").style("opacity","1")}addHoveredPercentile(t){lines_svg_dict[this.plotting_num].select(`.vertical-line-${this.plotting_num}-${t}`).classed("line-hovered-"+this.plotting_num,!0),this.clicked_indices.includes(t)&&(years_svg.select(`#years-line-${this.plotting_num}-${t}`).classed("years-line-hovered-"+this.plotting_num,!0),t==this.num_lines-1&&years_svg.select(`#years-line-${this.plotting_num}-${t+1}`).classed("years-line-hovered-"+this.plotting_num,!0))}removeHoveredPercentile(t){lines_svg_dict[this.plotting_num].select(`.vertical-line-${this.plotting_num}-${t}`).classed("line-hovered-"+this.plotting_num,!1),this.clicked_indices.includes(t)&&(years_svg.select(`#years-line-${this.plotting_num}-${t}`).classed("years-line-hovered-"+this.plotting_num,!1),t==this.num_lines-1&&years_svg.select(`#years-line-${this.plotting_num}-${t+1}`).classed("years-line-hovered-"+this.plotting_num,!1))}addClickedPercentile(t){lines_svg_dict[this.plotting_num].select(`.vertical-line-${this.plotting_num}-${t}`).classed(`line-clicked-${this.plotting_num} highlight-class-${this.plotting_num}`,!0).classed("line-not-clicked",!1),years_svg.select(`#years-line-${this.plotting_num}-${t}`).classed("years-line-clicked years-line-clicked-"+this.plotting_num,!0),t==this.num_lines-1&&years_svg.select(`#years-line-${this.plotting_num}-${t+1}`).classed("years-line-clicked years-line-clicked-"+this.plotting_num,!0)}addHoverOnClick(t){years_svg.select(`#years-line-${this.plotting_num}-${t}`).classed("years-line-hovered-"+this.plotting_num,!0),this.clicked_indices.push(t)}removeClickedPercentile(t){const e=this.clicked_indices.indexOf(t);this.clicked_indices.splice(e,1),lines_svg_dict[this.plotting_num].select(`.vertical-line-${this.plotting_num}-${t}`).classed(`line-clicked-${this.plotting_num} highlight-class-${this.plotting_num}`,!1).classed("line-not-clicked",!0),years_svg.select(`#years-line-${this.plotting_num}-${t}`).classed(`years-line-hovered-${this.plotting_num} years-line-clicked years-line-clicked-${this.plotting_num}`,!1),t==this.num_lines-1&&years_svg.select(`#years-line-${this.plotting_num}-${t+1}`).classed(`years-line-hovered-${this.plotting_num} years-line-clicked years-line-clicked-${this.plotting_num}`,!1)}removeAllHoveredPercentiles(){for(let t=this.hover_indices.length-1;t>=0;t--)this.removeHoveredPercentile(this.hover_indices[t]);this.hover_indices=[],this.hover_info=[-1,-1],is_hovering_years||(density_tooltip.style("opacity","0"),this.tooltip_percentile=void 0)}clickFunction(){for(let t=0;t<this.hover_indices.length;t++){let e=this.hover_indices[t];this.clicked_indices.includes(e)?this.removeClickedPercentile(e):(this.addClickedPercentile(e),this.addHoverOnClick(e))}}highlightClosest(){const t=findClosest(this.interpolated_incomes,x_coordinate),e=0==t?getAllZeroValues(this.interpolated_incomes,0):[this.interpolated_incomes.indexOf(t)],n=[e,e.length];if(n[0]!=this.hover_info[0]||n[1]!=this.hover_info[1]){if(this.hover_info[1]>0){for(let t=this.hover_info[1]-1;t>=0;t--)this.removeHoveredPercentile(this.hover_indices[t]);this.hover_indices=[]}this.hover_info=n;for(let t=0;t<n[1];t++)this.addHoveredPercentile(e[t]);this.hover_indices=e}this.showTooltip(d3.max(e),!0)}}function addYearTooltips(t,e){const n=animations_dict[e].interpolated_incomes[t]<=animations_dict[e].interpolated_incomes[36];d3.select("#background-years").selectAll(".years-tooltip").data(animations_dict[e].data_obj.incomes_dict[t].vals).html(t=>"$"+t.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g,",")).style("left",(function(t){return n?years_x_scale(t)+margins.left+tooltips_margin+"px":years_x_scale(t)+margins.left-this.clientWidth-tooltips_margin+"px"})).style("opacity","1")}function removeYearTooltips(){d3.select("#background-years").selectAll(".years-tooltip").style("opacity","0")}function widthAndHeightMinusMargins(t,e,n){return[e-t.right-t.left,n-t.top-t.bottom]}function getWidthAndHeight(){const t=document.getElementById("density-div").getBoundingClientRect();return[t.width,t.height-years_line_height]}function debounce(t,e){let n;return function(...i){n&&clearTimeout(n),n=setTimeout((function(){t(...i)}),e)}}function scroll(){if(!1===auto_scrolling){const t=content_obj.scrollTop/scroll_limit;t<1&&(document.getElementById("play-button").style.opacity=0,document.getElementById("pause-button").style.opacity=1,auto_scrolling=!0,d3.transition().duration((1-t)*scroll_duration).ease(d3.easeLinear).tween("scroll",scrollTween(scroll_limit)).on("end",(function(){document.getElementById("play-button").style.opacity=1,document.getElementById("pause-button").style.opacity=0,auto_scrolling=!1})))}}function scrollTween(t){return function(){let e=d3.interpolateNumber(content_obj.scrollTop,t);return function(t){content_obj.scrollTo(0,e(t))}}}function stopScrolling(){document.getElementById("pause-button").style.opacity=0,document.getElementById("play-button").style.opacity=1,d3.selectAll("*").interrupt(),auto_scrolling=!1}function cutAndScaleThresholds(){global_thresholds=uncut_tholds.filter(t=>t<=global_x_max),global_num_thresholds=global_thresholds.length,scaled_global_thresholds=global_thresholds.map(t=>x_scale(t))}function makeAxes(){num_x_ticks=ticks_scale(totalWidth),density_outer_group.append("g").attr("transform","translate(0,"+modifiedHeight+")").attr("class","axes x-axis").call(d3.axisBottom().scale(x_scale).ticks(num_x_ticks).tickSizeOuter(0).tickFormat(t=>tickFunction(t))),density_outer_group.append("g").classed("axes y-axis hidden",!0).call(d3.axisLeft(y_scale).tickSizeOuter(0).tickValues([])),grid_svg.selectAll(".grid-line").data(x_scale.ticks(num_x_ticks).slice(1),t=>t).enter().append("line").attr("class","hidden grid-line hidden").attr("x1",(function(t){return x_scale(t)})).attr("x2",(function(t){return x_scale(t)})).attr("y1",scaled_top).attr("y2",scaled_bottom)}function removeAxes(){grid_svg.selectAll(".grid-line").remove(),density_outer_group.selectAll(".axes").remove(),wrapper_svg.selectAll(".axis-label").remove()}function removePlotsandLines(){wrapper_svg.selectAll(".not-axes").remove()}function removeYearLinesAndTooltips(){years_svg.selectAll(".years-grid-line").remove(),years_svg_wrapper.selectAll(".year-info").remove(),d3.select("#background-years").selectAll(".years-tooltip").remove()}function makeScales(){x_scale=d3.scaleLinear().domain([0,global_x_max]).range([0,modifiedWidth]),y_scale=d3.scaleLinear().domain([0,global_y_max]).range([modifiedHeight,0]),years_x_scale=d3.scaleLinear().domain([0,global_x_max]).range([0,modifiedWidth]),years_y_scale=t=>t*years_distance+years_line_height}function updateAxes(){density_outer_group.select(".y-axis").transition().duration(500).call(d3.axisLeft(y_scale).tickSizeOuter(0).tickValues([])),density_outer_group.select(".x-axis").transition().duration(500).call(d3.axisBottom().scale(x_scale).tickSizeOuter(0).ticks(num_x_ticks).tickFormat(t=>tickFunction(t)))}function updateYearsGridLines(t){const e=years_svg.selectAll(".years-grid-line").data(t,t=>t),n=years_lower+years_line_height;e.enter().append("line").attr("class","years-grid-line").attr("y1",years_line_height).attr("y2",n).merge(e).attr("x1",(function(t){return years_x_scale(t)})).attr("x2",(function(t){return years_x_scale(t)})),e.exit().remove()}function updateYearsLines(t){years_svg.selectAll(".years-line-"+t).data(animations_dict[t].data_obj.incomes_dict).attr("d",(function(t){return line_function(t.vals)})),years_svg.select(`#years-line-${t}-${animations_dict[0].num_lines}`).attr("d",line_function(animations_dict[t].data_obj.incomes_dict[animations_dict[t].num_lines-1].vals))}function drawingFunctions(){curveFunction=d3.area().curve(d3.curveBasis).x((t,e)=>scaled_global_thresholds[e]).y1(t=>t).y0(scaled_bottom),clipFunction=d3.area().curve(d3.curveBasis).x((t,e)=>scaled_global_thresholds[e]).y1(t=>t).y0(scaled_top)}function globalInterpolate(){global_scroll_num=Math.max(Math.min(content_obj.scrollTop/scroll_limit,1),0)*(num_years-1),global_scroll_floor=Math.floor(global_scroll_num),animations_dict[0].redraw(),null!=animations_dict[1]&&animations_dict[1].redraw()}async function initialSetup(t){setHeight(),toolbarChanges(),setWindowEventListeners(),setToolbarListeners(),animations_dict[0]=new IncomeAnimation(0,await d3.json(t)),num_years=animations_dict[0].data_obj.incomes.length,global_scroll_num=Math.max(Math.min(content_obj.scrollTop/scroll_limit,1),0)*(num_years-1),global_scroll_floor=Math.floor(global_scroll_num),setGlobalMaxes(),makeScales(),cutAndScaleThresholds(),makeConstantScales(),drawingFunctions(),animations_dict[0].readyAnimation(),hoverActions(),makeAxes(),addAxisText(),makeYearsSvg(),makeYearsInfo(),makeYearsTooltips(),yearsLinesEventListeners(),makeUpperStrings(),d3.select(has_toolbar?"#content":window).on("scroll.scroller",globalInterpolate),has_mouse||d3.select("#density-enter-text").html("Tap and hold density plot to track income percentiles"),d3.selectAll(".hidden").classed("hidden",!1),d3.select("#legend").style("opacity","0.09"),is_small&&toggleToolbar(1e3)}function makeHoverRect(){hover_rect=hover_group.append("rect").attr("id","hover-rect").attr("x",0).attr("y",-1*margins.top).attr("width",modifiedWidth).attr("height",modifiedHeight+margins.top)}function hoverTimeout(){is_transitioning||animations_dict[current_selection].highlightClosest()}function stopHovering(){bottom_svg_hover=!1,has_legend&has_entered_mouse&&d3.select("#legend").style("opacity","1"),animations_dict[current_selection].removeAllHoveredPercentiles(),has_mouse||touchscreen_timeout&&clearTimeout(touchscreen_timeout)}function hoverActions(){makeHoverRect(),has_mouse?(hover_rect.on("mousemove",(function(){has_entered_mouse||removeDensityEnter(),x_coordinate=x_scale.invert(d3.mouse(this)[0]),!bottom_svg_hover&has_legend&&d3.select("#legend").style("opacity","0"),bottom_svg_hover=!0,hoverTimeout()})),hover_rect.on("mousedown",()=>{animations_dict[current_selection].clickFunction()}),hover_rect.on("mouseleave",stopHovering)):(hover_rect.on("touchstart",(function(){x_coordinate=x_scale.invert(d3.mouse(this)[0]),touchscreen_timeout=setTimeout((function(){has_entered_mouse||removeDensityEnter(),auto_scrolling&&stopScrolling(),has_legend&&d3.select("#legend").style("opacity","0"),bottom_svg_hover=!0,hoverTimeout()}),600)})),hover_rect.on("touchend",()=>{animations_dict[current_selection].clickFunction(),stopHovering()}),hover_rect.on("touchcancel",stopHovering),document.getElementById("hover-rect").addEventListener("touchmove",(function(t){x_coordinate=x_scale.invert(t.touches[0].clientX-margins.left),bottom_svg_hover&&(auto_scrolling&&stopScrolling(),t.cancelable&&t.preventDefault(),hoverTimeout())}),{passive:!1}))}function makeConstantScales(){scaled_bottom=y_scale(0),scaled_top=y_scale(global_y_max)-margins.top}function resize(){!0===auto_scrolling&&d3.selectAll("*").interrupt(),animations_dict[current_selection].removeAllHoveredPercentiles(),removeAxes(),removePlotsandLines(),removeYearLinesAndTooltips(),toolbarChanges(),setHeight(!0),has_legend="flex"==d3.select("#legend").style("display"),[totalWidth,totalHeight]=getWidthAndHeight(),margins=getMargins(),[modifiedWidth,modifiedHeight]=widthAndHeightMinusMargins(margins,totalWidth,totalHeight),setDensityEnter(),makeScales(),makeConstantScales(),adjustWidthsHeightsAndMargins(),scaled_global_thresholds=global_thresholds.map(t=>x_scale(t)),makeAxes(),addAxisText(),makeYearsInfo(),makeYearsTooltips(),yearsLinesEventListeners(),drawingFunctions(),animations_dict[0].readyAnimation(),animations_dict[1]&&animations_dict[1].readyAnimation(),d3.selectAll(".hidden").classed("hidden",!1),resumeScrollIfPaused()}function findClosest(t,e){return t.reduce((function(t,n,i){return Math.abs(n-e)<=Math.abs(t-e)?n:t}))}function getAllZeroValues(t){let e=[];for(let n=0;n<t.length;n++){if(0!==t[n])return e;e.push(n)}}function toggleDistributionSelection(){const t=0==current_selection?1:0;animations_dict[current_selection].removeAllHoveredPercentiles(),animations_dict[current_selection].is_selected=!1,animations_dict[1]&&(animations_dict[t].is_selected=!0,bottom_svg_hover&&animations_dict[t].highlightClosest(),show_group_icon&&(0==t?d3.select("#group-selection-svg").style("opacity","0.7").style("fill","crimson"):d3.select("#group-selection-svg").style("opacity","0.8").style("fill","dodgerblue"))),current_selection=t}function updateScrollSpeed(t){!0===auto_scrolling&&d3.selectAll("*").interrupt(),scroll_duration=t,resumeScrollIfPaused()}function makeUpperStrings(){const t=race_scale(animations_selections[0].race)+sex_scale(animations_selections[0].sex)+age_scale(animations_selections[0].age);if(document.getElementById("group-0-legend-text").innerHTML="workers"==t?"All workers":t.charAt(0).toUpperCase()+t.slice(1),animations_dict[1]){const t=race_scale(animations_selections[1].race)+sex_scale(animations_selections[1].sex)+age_scale(animations_selections[1].age);document.getElementById("group-1-legend-text").innerHTML="workers"==t?"All workers":t.charAt(0).toUpperCase()+t.slice(1)}}function addAxisText(){wrapper_svg.append("text").attr("class","hidden axis-label x-axis-label").attr("dominant-baseline","central").attr("transform",`translate(${margins.left+modifiedWidth/2}, ${totalHeight-margins.bottom/2+8.5})`).text("Annual income (2018 dollars)"),wrapper_svg.append("text").attr("class","hidden axis-label y-axis-label").attr("transform",`translate(${margins.left-d3.scaleOrdinal().domain([0,1,2]).range([14.5,17,21])(margins.ind)},${margins.top+modifiedHeight/2}) rotate(-90)`).text("Density")}function adjustYearsTooltips(){const t=document.getElementsByClassName("years-tooltip")[0].clientHeight;d3.select("#background-years").selectAll(".years-tooltip").style("transform",`translate(0,-${t+tooltips_margin}px)`)}function toggleToolbar(t=250){if(stopScrolling(),0==is_expanded)return is_expanded=!0,d3.select("#toolbar").transition().duration(t).style("left","0px"),d3.select("#plus-wrapper").transition().duration(t).style("transform","rotate(45deg)"),d3.select("#icon-wrapper").transition().duration(t).style("left","275px"),void d3.select("#border-hider").transition().duration(t).style("left","272px");is_expanded=!1,d3.select("#border-hider").transition().duration(t).style("left","-3px"),d3.select("#toolbar").transition().duration(t).style("left","-275px"),d3.select("#plus-wrapper").transition().duration(t).style("transform","rotate(0deg)"),d3.select("#icon-wrapper").transition().duration(t).style("left","0px")}function setWindowEventListeners(){window.addEventListener("wheel",(function(){auto_scrolling&&stopScrolling()})),window.addEventListener("mousedown",t=>{t.offsetX>document.body.clientWidth&&auto_scrolling&&stopScrolling()}),window.addEventListener("touchmove",(function(){auto_scrolling&&stopScrolling()})),window.addEventListener("keydown",(function(t){38==t.keyCode||40==t.keyCode?auto_scrolling&&stopScrolling():32==t.keyCode?(t.preventDefault(),!0===auto_scrolling?stopScrolling():scroll()):39==t.keyCode?(auto_scrolling&&stopScrolling(),global_scroll_num<num_years-1&&content_obj.scrollTo(0,(global_scroll_floor+1)/(num_years-1)*scroll_limit)):37==t.keyCode?(auto_scrolling&&stopScrolling(),global_scroll_num>0&&(global_scroll_num!=global_scroll_floor?content_obj.scrollTo(0,global_scroll_floor/(num_years-1)*scroll_limit):content_obj.scrollTo(0,(global_scroll_floor-1)/(num_years-1)*scroll_limit))):70==t.keyCode&&-1!=fullscreen_index&&toggleFullScreen()})),window.addEventListener("click",(function(t){document.getElementById("toolbar").contains(t.target)||is_expanded&&toggleToolbar()})),window.addEventListener("touchstart",(function(t){document.getElementById("toolbar").contains(t.target)||is_expanded&&toggleToolbar()})),window.onresize=debounce(resize,200),-1!=fullscreen_index?(document.addEventListener("webkitfullscreenchange",fullScreenFunction),document.addEventListener("mozfullscreenchange",fullScreenFunction),document.addEventListener("fullscreenchange",fullScreenFunction),document.addEventListener("MSFullscreenChange",fullScreenFunction),document.getElementById("screen-svg").addEventListener("click",toggleFullScreen)):(d3.select("#fullscreen-wrapper").style("display","none"),is_small&&(show_group_icon=!0))}function setToolbarListeners(){document.getElementById("player-svg").addEventListener("click",(function(){is_expanded&&toggleToolbar(),1==auto_scrolling?stopScrolling():scroll()})),document.getElementById("restart-svg").addEventListener("mousedown",(function(t){is_expanded&&toggleToolbar(),!0===auto_scrolling&&stopScrolling(),content_obj.scrollTo(0,0),scroll()})),document.getElementById("myRange").oninput=function(){updateScrollSpeed(-1*this.value)},document.querySelectorAll(".label-class-0").forEach((function(t){addRadioListener(t,0)})),document.querySelectorAll(".label-class-1").forEach((function(t){addRadioListener(t,1)})),document.getElementById("workers-selector").addEventListener("change",(function(){1==auto_scrolling?stopScrolling():wrapper_with_adjusted_margins.selectAll("*").interrupt();const t=this.value;animations_selections[0].work_type!=t&&(animations_selections[0].work_type=t,animations_selections[1].work_type=t,removeGroup(0),animations_dict[1]?(removeGroup(1),simpleUpdate(makeNewAccessingString(0),makeNewAccessingString(1))):simpleUpdate(makeNewAccessingString(0),void 0))})),document.querySelectorAll(".higlight-label").forEach((function(t){clickSelection(t)})),document.querySelectorAll(".group-dropdown").forEach((function(t){demographicDropdowns(t)}));const t=document.querySelectorAll(".button-1"),e=document.querySelector('input[type="checkbox"]');e.addEventListener("change",(function(){e.checked?(1==auto_scrolling?stopScrolling():wrapper_with_adjusted_margins.selectAll("*").interrupt(),second_group_disabled=!1,d3.select("#legend").style("height","50px"),has_legend&&d3.select("#legend-1-wrapper").style("display","flex"),t.forEach(t=>{t.disabled=!1}),document.querySelectorAll(".group-1-dropdown").forEach((function(t){t.disabled=!1})),simpleUpdate(animations_filenames[0],makeNewAccessingString(1)),toggleDisable(!0),show_group_icon&&(icon_group_currently_shown=!0,d3.select("#group-selection-svg").style("opacity","0.8").style("fill","dodgerblue"),d3.select("#group-selection-wrapper").style("display","block"))):(1==auto_scrolling?stopScrolling():wrapper_with_adjusted_margins.selectAll("*").interrupt(),second_group_disabled=!0,t.forEach(t=>{t.disabled=!0}),document.querySelectorAll(".group-1-dropdown").forEach((function(t){t.disabled=!0})),d3.select("#legend").style("height","28px"),has_legend&&d3.select("#legend-1-wrapper").style("display","none"),toggleDisable(!1),removeGroup(1),simpleUpdate(animations_filenames[0],void 0),show_group_icon&&(icon_group_currently_shown=!1,d3.select("#group-selection-wrapper").style("display","none")))})),document.getElementById("group-selection-svg").addEventListener("click",(function(){icon_group_currently_shown&&(document.getElementById(`group${current_selection}highlight`).checked=!1,document.getElementById(`group${0==current_selection?1:0}highlight`).checked=!0,toggleDistributionSelection())})),document.getElementById("plus-wrapper").addEventListener("click",(function(){toggleToolbar()}))}function fullScreenFunction(){document.getElementById("fullscreen").style.opacity=+fullscreen,document.getElementById("minimize").style.opacity=+!fullscreen,fullscreen=!fullscreen}function resumeScrollIfPaused(){auto_scrolling&&(auto_scrolling=!1,scroll())}function openFullscreen(t){0==t?document.documentElement.requestFullscreen():1==t?document.documentElement.mozRequestFullScreen():2==t?document.documentElement.webkitRequestFullscreen():3==t&&document.documentElement.msRequestFullscreen()}function closeFullscreen(t){0==t?document.exitFullscreen():1==t?document.mozCancelFullScreen():2==t?document.webkitExitFullscreen():3==t&&document.msExitFullscreen()}function getFullScreenIndices(){return document.documentElement.requestFullscreen?0:document.documentElement.mozRequestFullScreen?1:document.documentElement.webkitRequestFullscreen?2:document.documentElement.msRequestFullscreen?3:-1}function removeDensityEnter(){has_entered_mouse=!0,d3.select("#density-enter").remove(),density_enter_rect.remove(),d3.select("#legend").style("opacity","1")}function addRadioListener(t,e){t.addEventListener("click",(function(){if(0==e||0==second_group_disabled){const t=this.className.substring(14),n=this.id.slice(0,-1);animations_selections[e][t]!=n&&(1==auto_scrolling?stopScrolling():wrapper_with_adjusted_margins.selectAll("*").interrupt(),animations_selections[e][t]=n,removeGroup(e),0==e?simpleUpdate(makeNewAccessingString(0),animations_filenames[1]):simpleUpdate(animations_filenames[0],makeNewAccessingString(1)))}}))}function clickSelection(t){t.addEventListener("click",(function(){current_selection!=+t.id.slice(-1)&&toggleDistributionSelection()}))}function yearsLinesEventListeners(){d3.selectAll(".years-line").on(has_mouse?"mouseenter":"touchstart",(function(){const t=this.classList;if(is_hovering_years=!0,t.contains("years-line-clicked")){const e=t.contains("years-line-0")?0:1,n=this.id.slice(13);addYearTooltips(n,e),animations_dict[e].showTooltip(+n,!1),animations_dict[e].tooltip_percentile=+n}})).on(has_mouse?"mouseleave":"touchend",(function(){cancelYearToolTip(this.classList)})).on("touchcancel",(function(){cancelYearToolTip(this.classList)}))}function cancelYearToolTip(t){if(is_hovering_years=!1,t.contains("years-line-clicked")){const e=t.contains("years-line-0")?0:1;removeYearTooltips(),density_tooltip.style("opacity","0"),animations_dict[e].tooltip_percentile=void 0}}function makeNewAccessingString(t){return`./processed_data/${animations_selections[t].work_type}/${animations_selections[t].sex}/${animations_selections[t].age}/${animations_selections[t].race}/data.json`}function demographicDropdowns(t){t.addEventListener("change",(function(){const t=this.id,e=+t[6];if(0==e||0==second_group_disabled){const n=this.value,i=t.slice(8);animations_selections[e][i]!=n&&(1==auto_scrolling?stopScrolling():wrapper_with_adjusted_margins.selectAll("*").interrupt(),animations_selections[e][i]=n,removeGroup(e),0==e?simpleUpdate(makeNewAccessingString(0),animations_filenames[1]):simpleUpdate(animations_filenames[0],makeNewAccessingString(1)))}}))}function toggleFullScreen(){fullscreen?closeFullscreen(fullscreen_index):openFullscreen(fullscreen_index)}function setDensityEnter(){has_entered_mouse||density_enter_rect.attr("y",years_line_height).attr("width",totalWidth).attr("height",totalHeight)}function getMargins(){return window.matchMedia("(min-width:1350px)").matches?{top:40,right:40,bottom:80,left:145,ind:2}:window.matchMedia("(max-width: 785px), (max-height:515px)").matches?{top:40,right:35,bottom:55,left:105,ind:0}:{top:40,right:40,bottom:70,left:120,ind:1}}function toggleDisable(t){(t||1==current_selection)&&(toggleDistributionSelection(),document.getElementById("group0highlight").checked=!t,document.getElementById("group1highlight").checked=t),document.getElementById("group0highlight").disabled=!t,document.getElementById("group1highlight").disabled=!t}function adjustWidthsHeightsAndMargins(){wrapper_wrapper.attr("width",totalWidth).attr("height",totalHeight+years_line_height),wrapper_svg.attr("width",totalWidth).attr("height",totalHeight),wrapper_svg.select("#rect-svg").attr("width",totalWidth).attr("height",totalHeight-margins.top).attr("transform","translate(0,"+margins.top+")"),wrapper_svg.select("#rect-svg2").attr("width",totalWidth-margins.left).attr("height",totalHeight-margins.bottom).attr("transform","translate("+margins.left+",0)"),wrapper_with_adjusted_margins.attr("transform","translate("+margins.left+","+margins.top+")"),curr_year_line.attr("y1",years_line_height).attr("y2",years_line_height).attr("x2",margins.left-4.5).attr("x1",totalWidth-margins.right),years_svg.attr("transform","translate("+margins.left+",0)"),hover_rect.attr("x",0).attr("y",-1*margins.top).attr("width",modifiedWidth).attr("height",modifiedHeight+margins.top)}let scroll_duration=32e3;const has_mouse=!matchMedia("(hover: none)").matches;let is_expanded,animation_timeout,scroll_limit,years_distance,years_lower,years_upper,wheel_timeout,touchscreen_timeout,num_years,curveFunction,clipFunction,hover_rect,years_svg_wrapper,num_x_ticks,global_x_max,global_y_max,x_scale,y_scale,global_thresholds,scaled_global_thresholds,global_num_thresholds,global_scroll_num,global_scroll_floor,x_coordinate,scaled_bottom,scaled_top,years_svg,years_x_scale,years_y_scale,line_function,auto_scrolling=!1,bottom_svg_hover=!1,current_selection=0,years_line_height=8,animations_dict=[void 0,void 0],second_group_disabled=!0,animations_selections=[{work_type:"full_time",sex:"all_sexes",age:"all_ages",race:"all_races"},{work_type:"full_time",sex:"males",age:"from_30_to_49",race:"all_races"}],animations_filenames=["./processed_data/full_time/all_sexes/all_ages/all_races/data.json",void 0],shown_distributions=[!0,!1],is_transitioning=!1,tooltips_margin=5,fullscreen=!1,has_entered_mouse=!1,is_hovering_years=!1,show_group_icon=!1,icon_group_currently_shown=!1,has_toolbar=!1,content_obj=document.documentElement,is_small=void 0,has_legend="flex"==d3.select("#legend").style("display");const fullscreen_index=getFullScreenIndices(),density_tooltip=d3.select("#density-tooltip"),uncut_tholds=[0,2e3,4e3,6e3,8e3,1e4,12e3,14e3,16e3,18e3,2e4,22e3,24e3,26e3,28e3,3e4,32e3,34e3,36e3,38e3,4e4,42e3,44e3,46e3,48e3,5e4,52e3,54e3,56e3,58e3,6e4,62e3,64e3,66e3,68e3,7e4,72e3,74e3,76e3,78e3,8e4,82e3,84e3,86e3,88e3,9e4,92e3,94e3,96e3,98e3,1e5,102e3,104e3,106e3,108e3,11e4,112e3,114e3,116e3,118e3,12e4,122e3,124e3,126e3,128e3,13e4,132e3,134e3,136e3,138e3,14e4,142e3,144e3,146e3,148e3,15e4,152e3,154e3,156e3,158e3,16e4,162e3,164e3,166e3,168e3,17e4,172e3,174e3,176e3,178e3,18e4,182e3,184e3,186e3,188e3,19e4,192e3,194e3,196e3,198e3,2e5,202e3,204e3,206e3,208e3,21e4,212e3,214e3,216e3,218e3,22e4,222e3,224e3,226e3,228e3,23e4,232e3,234e3,236e3,238e3,24e4,242e3,244e3,246e3,248e3,25e4,252e3,254e3,256e3,258e3,26e4,262e3,264e3,266e3,268e3,27e4,272e3,274e3,276e3,278e3,28e4,282e3,284e3,286e3,288e3,29e4,292e3,294e3,296e3,298e3,3e5,302e3,304e3,306e3,308e3,31e4,312e3,314e3,316e3,318e3,32e4,322e3,324e3,326e3,328e3,33e4,332e3,334e3,336e3,338e3,34e4,342e3,344e3,346e3,348e3,35e4,352e3,354e3,356e3,358e3,36e4,362e3,364e3,366e3,368e3,37e4,372e3,374e3,376e3,378e3,38e4,382e3,384e3,386e3,388e3,39e4,392e3,394e3,396e3,398e3,4e5,402e3,404e3,406e3,408e3,41e4,412e3,414e3,416e3,418e3,42e4,422e3,424e3,426e3,428e3,43e4,432e3,434e3,436e3,438e3,44e4,442e3,444e3,446e3,448e3,45e4,452e3,454e3,456e3,458e3,46e4,462e3,464e3,466e3,468e3,47e4,472e3,474e3,476e3,478e3,48e4,482e3,484e3,486e3,488e3,49e4,492e3,494e3,496e3,498e3,5e5,502e3,504e3,506e3,508e3,51e4,512e3,514e3,516e3,518e3,52e4,522e3,524e3,526e3,528e3,53e4,532e3,534e3,536e3,538e3,54e4,542e3,544e3,546e3,548e3,55e4,552e3,554e3,556e3,558e3,56e4,562e3,564e3,566e3,568e3,57e4,572e3,574e3,576e3,578e3,58e4,582e3,584e3,586e3,588e3,59e4,592e3,594e3],race_scale=d3.scaleOrdinal().domain(["all_races","white_non_hispanic","black_non_hispanic","hispanic"]).range(["","white ","black ","hisp. "]),sex_scale=d3.scaleOrdinal().domain(["all_sexes","males","females"]).range(["workers","men","women"]),age_scale=d3.scaleOrdinal().domain(["all_ages","under_30","from_30_to_49","over_50"]).range([""," 16-29 "," 30-49 "," 50+"]),ticks_scale=d3.scaleThreshold().domain([300,700,1350]).range([2,4,5,8]);let[totalWidth,totalHeight]=getWidthAndHeight(),margins=getMargins(),[modifiedWidth,modifiedHeight]=widthAndHeightMinusMargins(margins,totalWidth,totalHeight);const wrapper_wrapper=d3.select("#density-div").append("svg").attr("width",totalWidth).attr("height",totalHeight+years_line_height),wrapper_svg=wrapper_wrapper.append("g").attr("id","wrapper-svg").attr("width",totalWidth).attr("height",totalHeight).attr("transform","translate(0,"+years_line_height+")");wrapper_svg.append("rect").attr("id","rect-svg").attr("width",totalWidth).attr("height",totalHeight-margins.top).attr("fill","white").attr("transform",`translate(0,${margins.top})`),wrapper_svg.append("rect").attr("id","rect-svg2").attr("width",totalWidth-margins.left).attr("height",totalHeight-margins.bottom).attr("fill","white").attr("transform","translate("+margins.left+",0)"),wrapper_wrapper.append("defs").append("marker").attr("id","arrow").attr("viewBox","0 -5 10 10").attr("refX",5).attr("refY",0).attr("markerWidth",3).attr("markerHeight",4).attr("orient","auto").append("path").attr("d","M0,-5L10,0L0,5").attr("class","arrowHead").style("fill","#545454");const wrapper_with_adjusted_margins=wrapper_svg.append("g").attr("transform","translate("+margins.left+","+margins.top+")"),grid_svg=wrapper_with_adjusted_margins.append("g"),density_svg_dict=[wrapper_with_adjusted_margins.append("g"),wrapper_with_adjusted_margins.append("g")],lines_svg_dict=[wrapper_with_adjusted_margins.append("g"),wrapper_with_adjusted_margins.append("g")],density_outer_group=wrapper_with_adjusted_margins.append("g").attr("class","hidden"),hover_group=wrapper_with_adjusted_margins.append("g"),density_enter_g=wrapper_wrapper.append("g"),density_enter_rect=density_enter_g.append("rect").attr("id","density-enter-rect").attr("y",years_line_height).attr("width",totalWidth).attr("height",totalHeight),curr_year_line=density_enter_g.append("line").attr("y1",years_line_height).attr("y2",years_line_height).attr("x2",margins.left-4.5).attr("x1",totalWidth-margins.right).attr("class","current-year-line hidden");initialSetup(animations_filenames[0]);